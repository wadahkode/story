"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function _regeneratorRuntime(){_regeneratorRuntime=function(){return i};var i={},t=Object.prototype,c=t.hasOwnProperty,e="function"==typeof Symbol?Symbol:{},n=e.iterator||"@@iterator",r=e.asyncIterator||"@@asyncIterator",o=e.toStringTag||"@@toStringTag";function a(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{a({},"")}catch(t){a=function(t,e,r){return t[e]=r}}function s(t,e,r,n){var o,a,i,s,e=e&&e.prototype instanceof d?e:d,e=Object.create(e.prototype),n=new k(n||[]);return e._invoke=(o=t,a=r,i=n,s="suspendedStart",function(t,e){if("executing"===s)throw new Error("Generator is already running");if("completed"===s){if("throw"===t)throw e;return w()}for(i.method=t,i.arg=e;;){var r=i.delegate;if(r){r=function t(e,r){var n=e.iterator[r.method];if(void 0===n){if(r.delegate=null,"throw"===r.method){if(e.iterator.return&&(r.method="return",r.arg=void 0,t(e,r),"throw"===r.method))return u;r.method="throw",r.arg=new TypeError("The iterator does not provide a 'throw' method")}return u}n=l(n,e.iterator,r.arg);if("throw"===n.type)return r.method="throw",r.arg=n.arg,r.delegate=null,u;n=n.arg;return n?n.done?(r[e.resultName]=n.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=void 0),r.delegate=null,u):n:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,u)}(r,i);if(r){if(r===u)continue;return r}}if("next"===i.method)i.sent=i._sent=i.arg;else if("throw"===i.method){if("suspendedStart"===s)throw s="completed",i.arg;i.dispatchException(i.arg)}else"return"===i.method&&i.abrupt("return",i.arg);s="executing";r=l(o,a,i);if("normal"===r.type){if(s=i.done?"completed":"suspendedYield",r.arg===u)continue;return{value:r.arg,done:i.done}}"throw"===r.type&&(s="completed",i.method="throw",i.arg=r.arg)}}),e}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}i.wrap=s;var u={};function d(){}function m(){}function f(){}var e={},h=(a(e,n,function(){return this}),Object.getPrototypeOf),h=h&&h(h(S([]))),p=(h&&h!==t&&c.call(h,n)&&(e=h),f.prototype=d.prototype=Object.create(e));function y(t){["next","throw","return"].forEach(function(e){a(t,e,function(t){return this._invoke(e,t)})})}function g(i,s){var e;this._invoke=function(r,n){function t(){return new s(function(t,e){!function e(t,r,n,o){var a,t=l(i[t],i,r);if("throw"!==t.type)return(r=(a=t.arg).value)&&"object"==_typeof(r)&&c.call(r,"__await")?s.resolve(r.__await).then(function(t){e("next",t,n,o)},function(t){e("throw",t,n,o)}):s.resolve(r).then(function(t){a.value=t,n(a)},function(t){return e("throw",t,n,o)});o(t.arg)}(r,n,t,e)})}return e=e?e.then(t,t):t()}}function v(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function b(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function k(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(v,this),this.reset(!0)}function S(e){if(e){var r,t=e[n];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length))return r=-1,(t=function t(){for(;++r<e.length;)if(c.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t}).next=t}return{next:w}}function w(){return{value:void 0,done:!0}}return a(p,"constructor",m.prototype=f),a(f,"constructor",m),m.displayName=a(f,o,"GeneratorFunction"),i.isGeneratorFunction=function(t){t="function"==typeof t&&t.constructor;return!!t&&(t===m||"GeneratorFunction"===(t.displayName||t.name))},i.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,f):(t.__proto__=f,a(t,o,"GeneratorFunction")),t.prototype=Object.create(p),t},i.awrap=function(t){return{__await:t}},y(g.prototype),a(g.prototype,r,function(){return this}),i.AsyncIterator=g,i.async=function(t,e,r,n,o){void 0===o&&(o=Promise);var a=new g(s(t,e,r,n),o);return i.isGeneratorFunction(e)?a:a.next().then(function(t){return t.done?t.value:a.next()})},y(p),a(p,o,"Generator"),a(p,n,function(){return this}),a(p,"toString",function(){return"[object Generator]"}),i.keys=function(r){var t,n=[];for(t in r)n.push(t);return n.reverse(),function t(){for(;n.length;){var e=n.pop();if(e in r)return t.value=e,t.done=!1,t}return t.done=!0,t}},i.values=S,k.prototype={constructor:k,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(b),!t)for(var e in this)"t"===e.charAt(0)&&c.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(r){if(this.done)throw r;var n=this;function t(t,e){return a.type="throw",a.arg=r,n.next=t,e&&(n.method="next",n.arg=void 0),!!e}for(var e=this.tryEntries.length-1;0<=e;--e){var o=this.tryEntries[e],a=o.completion;if("root"===o.tryLoc)return t("end");if(o.tryLoc<=this.prev){var i=c.call(o,"catchLoc"),s=c.call(o,"finallyLoc");if(i&&s){if(this.prev<o.catchLoc)return t(o.catchLoc,!0);if(this.prev<o.finallyLoc)return t(o.finallyLoc)}else if(i){if(this.prev<o.catchLoc)return t(o.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return t(o.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;0<=r;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&c.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var o=n;break}}var a=(o=o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc?null:o)?o.completion:{};return a.type=t,a.arg=e,o?(this.method="next",this.next=o.finallyLoc,u):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),u},finish:function(t){for(var e=this.tryEntries.length-1;0<=e;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),b(r),u}},catch:function(t){for(var e=this.tryEntries.length-1;0<=e;--e){var r,n,o=this.tryEntries[e];if(o.tryLoc===t)return"throw"===(r=o.completion).type&&(n=r.arg,b(o)),n}throw new Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:S(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=void 0),u}},i}function asyncGeneratorStep(t,e,r,n,o,a,i){try{var s=t[a](i),c=s.value}catch(t){return void r(t)}s.done?e(c):Promise.resolve(c).then(n,o)}function _asyncToGenerator(s){return function(){var t=this,i=arguments;return new Promise(function(e,r){var n=s.apply(t,i);function o(t){asyncGeneratorStep(n,e,r,o,a,"next",t)}function a(t){asyncGeneratorStep(n,e,r,o,a,"throw",t)}o(void 0)})}}function loginComponent(t){t.root.innerHTML='\n    <div class="container-login">\n      <div id="error"></div>\n      <form class="form-login" method="post">\n        <div class="input-group">\n          <label>Username</label>\n          <input type="text" id="username" class="input-control username" placeholder="input username" required/>\n        </div>\n        <div class="input-group">\n          <label>Password</label>\n          <input type="password" id="password" class="input-control password" placeholder="input password" required/>\n        </div>\n        <div class="input-help">\n          <div class="input-remember">\n            <input type="checkbox" id="remember" class="input-control" value="off"/> remember me\n          </div>\n          <div>\n            <a href="#">forget password?</a>\n          </div>\n        </div>\n        <button type="submit" id="btn-login">Login</button>\n      </form>\n      \n      <div>\n        Don\'t have an account yet? <a href="#">Register now</a>\n      </div>\n    </div>\n  '}function sampleRequest(){var r=new FileReader,n=new Blob([JSON.stringify([{id:1,title:"Title 1",name:"wadahkode",story:"Blabla",liked:[],comments:[]},{id:2,title:"Title 2",name:"wadahkode",story:"Blibli",liked:[],comments:[]},{id:3,title:"Title 3",name:"wadahkode",story:"Blublu",liked:[],comments:[]},{id:4,title:"Title 4",name:"wadahkode",story:"Bleble",liked:[],comments:[]},{id:5,title:"Title 5",name:"wadahkode",story:"Bloblo",liked:[],comments:[]}],null,2)],{type:"application/json"});return new Promise(function(e,t){r.onload=function(t){return e(JSON.parse(t.target.result))},r.readAsText(n)})}!function(){var e=_asyncToGenerator(_regeneratorRuntime().mark(function t(e){return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:null!==localStorage.getItem("userData")?t.next=5:(loginComponent({root:document.querySelector(".container")}),t.next=12);break;case 5:return t.t0=storyComponent,t.t1=e,t.next=9,sampleRequest();case 9:t.t2=t.sent,t.t3={root:t.t1,data:t.t2},(0,t.t0)(t.t3);case 12:case"end":return t.stop()}},t)}));return function(t){return e.apply(this,arguments)}}()(document.getElementById("root"));var getUserData=function(){var t=_asyncToGenerator(_regeneratorRuntime().mark(function t(){var e;return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e=null,localStorage.getItem("userData")&&(e=JSON.parse(localStorage.getItem("userData"))),t.next=4,e;case 4:return t.abrupt("return",t.sent);case 5:case"end":return t.stop()}},t)}));return function(){return t.apply(this,arguments)}}();function storyComponent(r){localStorage.getItem("data")&&(r.data=JSON.parse(localStorage.getItem("data"))),r.data.forEach(function(t,e){return r.root.innerHTML+='\n    <div class="card card-default">\n      <div class="card-header">\n        <div>\n          <h2>'.concat(t.title,"</h2>\n          <sub>@").concat(t.name,'</sub>\n        </div>\n      </div>\n      <div class="card-body">\n        <p>').concat(t.story,'</p>\n      </div>\n      <div class="card-footer">\n        <ul class="total">\n          <li class="total-liked">').concat(t.liked.length,' like</li>\n          <li>|</li>\n          <li class="total-comments">').concat(t.comments.length,' comment</li>\n        </ul>\n        \n        <div class="btn-group">\n          <button type="button" class="btn-default btn-like" data-target="').concat(e,'">👍</button>\n          <button type="button" class="btn-default btn-comment" data-target="').concat(e,'">💬</button>\n        </div>\n        <div class="form-comment">\n          <textarea class="editor" placeholder="Write comment..." data-target="').concat(e,'"></textarea>\n          <button type="button" class="btn-default btn-submit comment" disabled="true">send</button>\n        </div>\n        <ul class="container-comment">\n          <li>tidak ada komentar</li>\n        </ul>\n      </div>\n    </div>\n  ')})}var saveStory=function(){var e=_asyncToGenerator(_regeneratorRuntime().mark(function t(e){var r,n,o,a,i;return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,sampleRequest();case 2:return r=t.sent,localStorage.getItem("data")&&(r=JSON.parse(localStorage.getItem("data"))),n=parseInt(r.length)+1,o="anonymous",a=titleStory.value.length<1?"Untitled "+n:titleStory.value,t.next=9,getUserData();case 9:null!==(i=t.sent)&&(o=i[0].username),e={id:n,title:a,name:o,story:e,liked:[],comments:[]},r.push(e),editorStory.value="",titleStory.value="",btnStory.disabled=!0,localStorage.setItem("data",JSON.stringify(r)),location.reload();case 18:case"end":return t.stop()}},t)}));return function(t){return e.apply(this,arguments)}}(),btnStory=document.querySelector(".btn-story"),editorStory=document.querySelector(".editor-story"),titleStory=document.querySelector(".title-story"),error=(null!=editorStory&&editorStory.addEventListener("keyup",function(t){var e=t.currentTarget;1<=e.value.length?btnStory.disabled=!1:btnStory.disabled=!0,btnStory.onclick=function(t){t.preventDefault(),saveStory(e.value)}}),[{type:"ACCOUNT_NOT_READY",message:"username could not be found!"},{type:"PASSWORD_WRONG",message:"Password wrong!"},{type:"SUCCESS",message:"Successfully, please wait..."}]),formLogin=document.querySelector(".form-login"),userData=[{username:"admin",password:"admin",remember:!1}],containerError=document.getElementById("error"),auth=function(t){var e=t.username,r=t.password,n=t.remember,t=userData.map(function(t){return t.username!==e.value?(containerError.innerHTML=error[0].message,containerError.classList.add(error[0].type),null):t.password!==r.value?(containerError.innerHTML=error[1].message,containerError.classList.add(error[1].type),null):(t.remember=n.checked,t)});if(null===t[0])return formLogin.reset(),!1;localStorage.setItem("userData",JSON.stringify(t)),containerError.innerHTML=error[2].message,containerError.classList.add(error[2].type),setTimeout(function(){location.reload()},3e3)},removeError=(null===localStorage.getItem("userData")&&(formLogin.onsubmit=function(t){t.preventDefault(),auth(t.currentTarget)}),setInterval(function(){if(!containerError)return clearInterval(removeError),!1;""!==containerError.innerHTML&&setTimeout(function(){containerError.innerHTML="",containerError.removeAttribute("class")},2e3)},200)),RealtimeComment=function(){function e(t){_classCallCheck(this,e),this.btnComment=[],this.btnSubmit=[],this.containerComments=[],this.data=[],this.editor=[],this.formComment=[],this.keyboard={},this.keyboardHistory=[],this.totalComments=[]}var t,r,n,o,a,i;return _createClass(e,[{key:"getData",value:(i=_asyncToGenerator(_regeneratorRuntime().mark(function t(){var r=this;return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,sampleRequest();case 2:this.data=t.sent,localStorage.getItem("data")&&JSON.parse(localStorage.getItem("data")).filter(function(t,e){if(!r.data[e])return r.data.push(t)});case 4:case"end":return t.stop()}},t,this)})),function(){return i.apply(this,arguments)})},{key:"handleToggleComment",value:(a=_asyncToGenerator(_regeneratorRuntime().mark(function t(e){var r;return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:r=e.currentTarget,r=r.dataset.target,this.formComment[r].classList.toggle("active");case 3:case"end":return t.stop()}},t,this)})),function(t){return a.apply(this,arguments)})},{key:"handleChange",value:(o=_asyncToGenerator(_regeneratorRuntime().mark(function t(e){var r,n,o=this;return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:r=e.currentTarget,n=r.dataset.target,this.btnSubmit=this.formComment[n].querySelector(".btn-submit"),1<=r.value.length?this.btnSubmit.disabled=!1:this.btnSubmit.disabled=!0,this.btnSubmit.onclick=function(){o.formComment[n].classList.remove("active"),o.keyboard={id:n,name:"Anonymous",value:r.value},r.value="",o.saveComment()};case 5:case"end":return t.stop()}},t,this)})),function(t){return o.apply(this,arguments)})},{key:"saveComment",value:(n=_asyncToGenerator(_regeneratorRuntime().mark(function t(){return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:localStorage.getItem("dataComment")&&localStorage.getItem("keyboardHistory")&&(this.data=JSON.parse(localStorage.getItem("dataComment")),this.keyboardHistory=JSON.parse(localStorage.getItem("keyboardHistory"))),this.data[this.keyboard.id].comments.push(this.keyboard),this.keyboardHistory.push(this.keyboard),localStorage.setItem("dataComment",JSON.stringify(this.data)),localStorage.setItem("keyboardHistory",JSON.stringify(this.keyboardHistory)),window.onload();case 6:case"end":return t.stop()}},t,this)})),function(){return n.apply(this,arguments)})},{key:"realtimeContext",value:(r=_asyncToGenerator(_regeneratorRuntime().mark(function t(){var e,r=this;return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e=setInterval(function(){localStorage.getItem("dataComment")&&localStorage.getItem("keyboardHistory")&&(r.data=JSON.parse(localStorage.getItem("dataComment")),r.keyboardHistory=JSON.parse(localStorage.getItem("keyboardHistory"))),1<=r.keyboardHistory.length&&r.keyboardHistory.map(function(t){var e=r.data[t.id].comments.length;r.totalComments[t.id].innerHTML=e+" comment"})},200),t.abrupt("return",function(){clearInterval(e)});case 2:case"end":return t.stop()}},t)})),function(){return r.apply(this,arguments)})},{key:"start",value:(t=_asyncToGenerator(_regeneratorRuntime().mark(function t(){var r=this;return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.getData();case 2:if(this.btnComment=document.querySelectorAll(".btn-comment"),this.btnSubmit=document.querySelectorAll(".btn-submit"),this.containerComments=document.querySelectorAll(".container-comment"),this.editor=document.querySelectorAll(".editor"),this.formComment=document.querySelectorAll(".form-comment"),this.totalComments=document.querySelectorAll(".total-comments"),this.btnComment.length<1)return t.abrupt("return",!1);t.next=10;break;case 10:return this.btnComment.forEach(function(t){t.onclick=function(t){return r.handleToggleComment(t)}}),this.editor.forEach(function(t){t.onkeyup=function(t){return r.handleChange(t)}}),t.next=14,this.realtimeContext();case 14:window.onload=function(){localStorage.getItem("dataComment")&&localStorage.getItem("keyboardHistory")&&(r.data=JSON.parse(localStorage.getItem("dataComment")),r.keyboardHistory=JSON.parse(localStorage.getItem("keyboardHistory"))),r.data.map(function(t){var e=t.comments.map(function(t){if(t.id in r.containerComments)return'\n              <li>\n                <div class="card-comments">\n                  <div>\n                    <h2>'.concat(t.name,"</h2>\n                  </div>\n                  <div>\n                    ").concat(t.value,"\n                  </div>\n                </div>\n              </li>\n            ")});t.comments.map(function(t){r.containerComments[t.id].innerHTML=e.join(""),r.containerComments[t.id].classList.add("active")})})},window.onload();case 16:case"end":return t.stop()}},t,this)})),function(){return t.apply(this,arguments)})}]),e}(),RealtimeLiked=((new RealtimeComment).start(),function(){function e(t){_classCallCheck(this,e),this.btnLike=[],this.data=[],this.totalLiked=[]}var t,r,n;return _createClass(e,[{key:"handleLiked",value:(n=_asyncToGenerator(_regeneratorRuntime().mark(function t(e){var r,n,o=this;return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:r=e.currentTarget,n=r.dataset.target,localStorage.getItem("data")&&JSON.parse(localStorage.getItem("data")).filter(function(t,e){if(!o.data[e])return o.data.push(t)}),r.classList.contains("liked")&&localStorage.getItem("dataLiked")?(this.data[n].liked.pop({id:n,value:this.data[n].liked.length+1,text:"👍"}),r.classList.remove("liked")):(this.data[n].liked.push({id:n,value:this.data[n].liked.length+1,text:"👎"}),r.classList.add("liked")),localStorage.setItem("dataLiked",JSON.stringify(this.data));case 5:case"end":return t.stop()}},t,this)})),function(t){return n.apply(this,arguments)})},{key:"start",value:(r=_asyncToGenerator(_regeneratorRuntime().mark(function t(){var e=this;return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.getData();case 2:if(this.totalLiked=document.querySelectorAll(".total-liked"),this.btnLike=document.querySelectorAll(".btn-like"),this.btnLike.forEach(function(t){return t.onclick=function(t){return e.handleLiked(t)}}),this.btnLike.length<1)return t.abrupt("return",!1);t.next=7;break;case 7:this.realtimeContext();case 8:case"end":return t.stop()}},t,this)})),function(){return r.apply(this,arguments)})},{key:"realtimeContext",value:function(){var r=this,t=setInterval(function(){localStorage.getItem("dataLiked")&&(r.data=JSON.parse(localStorage.getItem("dataLiked"))),r.data.map(function(t,e){1<=t.liked.length?t.liked.forEach(function(t){r.totalLiked[t.id].innerHTML=t.value+" like",r.btnLike[t.id].innerHTML=t.text,r.btnLike[t.id].classList.add("liked")}):(r.totalLiked[e].innerHTML=t.liked.length+" like",r.btnLike[e].innerHTML="👍",r.btnLike[e].classList.remove("liked"))})},200);return function(){clearInterval(t)}}},{key:"getData",value:(t=_asyncToGenerator(_regeneratorRuntime().mark(function t(){var r=this;return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,sampleRequest();case 2:this.data=t.sent,localStorage.getItem("data")&&JSON.parse(localStorage.getItem("data")).filter(function(t,e){if(!r.data[e])return r.data.push(t)});case 4:case"end":return t.stop()}},t,this)})),function(){return t.apply(this,arguments)})}]),e}());(new RealtimeLiked).start();